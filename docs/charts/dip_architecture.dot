// dot docs/charts/dip_architecture.dot -Tpng > docs/charts/dip_architecture.png
// requires installation of GraphViz (brew install graphviz, or
// http://www.graphviz.org/Download..php if that doesn't work)

digraph G {
  label="Discovery Index Architecture";
  labelloc=t;
  node [style=filled];

  s3[label="AWS S3 Bucket", color=darkorange]
  s3Event[label="s3 bucket event triggers aws lamda", color=green]
  newIndex[label="create new elasticsearch index", color=green]
  process[label="read data from s3 and process as needed", color=green]
  writeIndex[label="write to elasticsearch index we created", color=darkorange]
  updateAlias[label="update alias to point to new index", color=green]
  moveToProcessedBucket[label="move data file to completed bucket", color=green]

  s3 -> s3Event
  s3Event -> newIndex
  newIndex -> process
  process -> writeIndex
  writeIndex -> updateAlias
  process -> moveToProcessedBucket
}
